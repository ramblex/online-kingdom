<% div_for article, :class => 'news-content' do %>
  <h1><%= link_to article.title, article, :class => 'news-title' %></h1>
  <div class="date">Posted on <%= article.created_at.strftime "%d %B %Y at %H:%M %Z" %></div>
  <%= admin_links article %>
  <div class="news-rating"><%= stars_for article %></div>
  <p><%= truncate_html(article.preamble, :length => 320) %></p>
  <a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="OnlineKingdom">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
<% end %>
<%= image_tag article.image.url(:default), :class => 'news-picture' if article.image? %>

<% if user_signed_in? %>
<script type="text/javascript">
  $(".stars a").click(function() {
    rating = $(this).attr('id');
    article = $(this).closest('.news-content').attr('id').split('_')[1];
    $(".stars a").removeClass('filled');
    $(this).addClass('filled');
    $(this).prevAll('a').addClass('filled');
  });

  $(".stars a").hover(function() {
    $(this).addClass('prev-filled');
    $(this).prevAll('a').addClass('prev-filled');
  }, function() {
    $(".stars a").removeClass('prev-filled');
  });
</script>
<% end %>
